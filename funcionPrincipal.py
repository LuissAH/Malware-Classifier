import os

# Ruta del archivo de códigos 1
archivo1 = "APT-CON/unicos.txt"

# Ruta de la carpeta de códigos 2
carpeta2 = "APT30-"

# Ruta del archivo de salida
archivo_salida = "APT-FIN/resultados30.txt"


# Leer los códigos del archivo 1 y contar su frecuencia
codigos1 = {}
with open(archivo1, "r") as f1:
    for line in f1:
        codigo = line.strip()
        codigos1[codigo] = 0

# Crear una lista para almacenar los resultados
resultados = []

# Procesar cada archivo en la carpeta 2
for archivo2 in os.listdir(carpeta2):
    if archivo2.endswith(".txt"):
        ruta_archivo2 = os.path.join(carpeta2, archivo2)
        
        # Leer el nombre del archivo2
        nombre_archivo2 = archivo2.split("/")[-1]

        # Restablecer las frecuencias de los códigos a cero
        codigos2 = codigos1.copy()

        # Contar la frecuencia de los códigos del archivo 1 en el archivo 2
        with open(ruta_archivo2, "r") as f2:
            for line in f2:
                codigo = line.strip()
                if codigo in codigos2:
                    codigos2[codigo] += 1

        # Obtener las frecuencias ordenadas de los códigos del archivo 1
        codigos_ordenados = [str(codigos2[codigo]) for codigo in codigos1]

        # Crear la línea de resultado con el nombre del archivo2 y las frecuencias
        resultado_linea = f"{nombre_archivo2},{','.join(codigos_ordenados)},{carpeta2}"

        # Agregar la línea de resultado a la lista de resultados
        resultados.append(resultado_linea)

# Escribir los resultados en el archivo de salida
with open(archivo_salida, "w") as salida:
    for resultado in resultados:
        salida.write(resultado + '\n')
