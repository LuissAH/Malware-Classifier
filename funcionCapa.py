import os
import subprocess

# Ruta al archivo de entrada
input_dir = "APT1"
# Ruta a la carpeta de salida
output_dir = "APT1-RESULTADOS"
# Ruta al archivo de reglas
rules_file = "capa-rules-master"

# Obtener una lista de archivos en el directorio de entrada
files = os.listdir(input_dir)

# Iterar sobre los archivos y ejecutar el comando en cada uno
for file in files:
    # Comprobar que el archivo es un archivo regular
    if os.path.isfile(os.path.join(input_dir, file)):
        # Ejecutar el comando en el archivo
        input_path = os.path.join(input_dir, file)
        output_path = os.path.join(output_dir, file + ".txt")
        capa_command = f"./capa -vv -r {rules_file}"
        result = subprocess.run(f"{capa_command} {input_path} > {output_path}", shell=True)
